## 5. 解析解法（ OLS，普通最小二乘法 ）

#### 5.1 核心思想

- **直接通过数学公式一步计算全局最优解，无需迭代过程**
- 数学基础：令代价函数的偏导数等于零求解极值点
- 适用于线性回归的正规方程（ Normal Equation ）方法
- 算法特性
  - 时间复杂度 $O(n^3)$：矩阵求逆的代价高，特征维度 > 10000 时效率低
  - 空间复杂度 $O(n^2)$：需存储 $\mathbf{X}^T\mathbf{X}$
  - 适用条件 $\mathbf{X}^T\mathbf{X}$：必须可逆，否则需正则化或伪逆
  - 样本要求 $m \geq n+1$：样本数 ≥ 特征数 + 1

#### 5.2 矩阵表示法

- 定义设计矩阵 $\mathbf{X}$ 和目标向量 $\mathbf{y}$：
  $$
  \mathbf{X} = \begin{bmatrix}
  1 & x_1^{(1)} & x_2^{(1)} & \cdots & x_n^{(1)} \\
  1 & x_1^{(2)} & x_2^{(2)} & \cdots & x_n^{(2)} \\
  \vdots & \vdots & \vdots & \ddots & \vdots \\
  1 & x_1^{(m)} & x_2^{(m)} & \cdots & x_n^{(m)}
  \end{bmatrix}, \quad
  \mathbf{y} = \begin{bmatrix}
  y^{(1)} \\
  y^{(2)} \\
  \vdots \\
  y^{(m)}
  \end{bmatrix}, \quad
  \mathbf{w} = \begin{bmatrix}
  b \\
  w_1 \\
  w_2 \\
  \vdots \\
  w_n
  \end{bmatrix}
  $$

#### 5.3 正规方程

- 正规方程是线性回归中直接求解最优参数的闭式解公式，它通过矩阵运算一步计算出全局最优解
  $$
  \mathbf{w} = (\mathbf{X}^T \mathbf{X})^{-1} \mathbf{X}^T \mathbf{y}
  $$
- 推导过程从代价函数出发，通过数学变换得到正规方程的过程
  - 代价函数矩阵形式
    $$
    J(\mathbf{w}) = \frac{1}{2m} (\mathbf{X}\mathbf{w} - \mathbf{y})^T(\mathbf{X}\mathbf{w} - \mathbf{y})
    $$
  - 对 $\mathbf{w}$ 求导并置零
    $$
    \begin{align*}
    \nabla_{\mathbf{w}} J(\mathbf{w}) &= \frac{1}{m} \mathbf{X}^T(\mathbf{X}\mathbf{w} - \mathbf{y}) = 0 \\
    \Rightarrow \mathbf{X}^T\mathbf{X}\mathbf{w} &= \mathbf{X}^T\mathbf{y}
    \end{align*}
    $$
