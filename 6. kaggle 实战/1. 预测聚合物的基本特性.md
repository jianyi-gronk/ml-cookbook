## 1. 题目介绍

- 题目：[预测聚合物的基本特性](https://www.kaggle.com/competitions/neurips-open-polymer-prediction-2025)
- 数据集：由 7973 条数据，1 个特征组成，包含
  - SMILES：聚合物结构的类序列化学符号
- 目标变量
  - Tg：玻璃化转变温度
  - FFV：自由体积分数，训练数据中只有
  - Tc：热导率
  - Density：聚合物密度
  - Rg：回转半径
- 评估：通过 wMAE（ 平均绝对误差 ）评估

## 2. 数据预处理

#### 2.1 引入外部数据集

- 训练数据集存在两个较大问题
  - 数据量较少，只有 7973 条
  - 目标变量缺失严重
    - Tg 只有 511 个非缺失值
    - FFV 只有 7030 个非缺失值
    - Tc 只有 737 个非缺失值
    - Density 只有 613 个非缺失值
    - Rg 只有 614 个非缺失值
- 因此，非常需要外部数据集来扩充训练数据并填补缺失值，具体步骤
  - 引入新的数据表格
  - 优先保留训练数据中的目标值，如果训练数据中缺失，才用引入数据填补
  - 将引入数据中独有的 SMILES 添加到训练集
- 最终结果
  - 数据量增长到 9261 条
  - 目标变量缺失
    - Tg 有 1161 个非缺失值
    - FFV 有 7030 个非缺失值
    - Tc 有 866 个非缺失值
    - Density 有 1247 个非缺失值
    - Rg 有 614 个非缺失值

#### 2.2 特征工程（ 针对所有目标变量 ）

- 原始特征只有 SMILES，显然不能直接作为模型输入，因为是 SMILES 是文本特征，高维稀疏向量，训练集中每一个 SMILES 的值都是不同的，模型不能直接通过 SMILES 学习到化学含义
- 因此需要将文本特征转换成化学描述
  - 计算 200+ 种化学分子描述符（ 使用 RDKit ）
  - 计算 20 种基于分子图的拓扑特征（ 使用 NetworkX ）
- 最终结果
  - 添加了 225 个特征

#### 2.3 特征工程（ 针对某一个目标变量 ）

- 因为我们这次的核心思路是 根据不同的 目标变量 进行分别预测，所以针对不同的 目标变量 我们进行不同的数据处理
- 先基于每个目标变量，复制一份新的数据集，并进行基础操作
  - 只保留 当前目标变量有值 的样本
  - 删除无用的特征，包括 空值比例占 50% 以上的特征 和 常量特征
  - 让 gpt 筛选出 从化学分析上来看 最没有影响的 n 个特征，然后将其删除（ gpt 不够智能，不要让其一次性生成太多，可能会误删除重要特征，可以每次让 gpt 删除 5 个，并给出删除理由 ）
- 特征进行 n 元组合，但是由于数据量较小，就算直接只进行二元组合，特征数量也会过大，因此直接让 gpt 针对每个目标变量，给出指定数量的 n 元最佳组合
  - "Tg" 有 1161 条数据，gpt 给出 20 个 n 元最佳组合
  - "FFV" 有 7030 条数据，gpt 给出 100 个 n 元最佳组合
  - "Tc" 有 866 条数据，gpt 给出 20 个 n 元最佳组合
  - "Density" 有 1247 条数据，gpt 给出 20 个 n 元最佳组合
  - "Rg" 有 614 条数据，gpt 给出 20 个 n 元最佳组合
- 删除与其他特征高度相关的特征，阈值尝试 0.75，0.8，0.85，0.9，0.95，1
  - 识别并移除高度相关特征
    - 列 A：最大值 0.97 > 0.8 → 标记删除
    - 列 B：最大值 0.25 < 0.8 → 保留
    - 列 C：最大值 0.72 < 0.8 → 保留
    - 列 D：全 NaN → 保留
- 对分类特征进行处理
  - 使用目标编码，获取特征与目标变量的关系（ 值类别小于等于 10 种 ）
    - ~~并保留原始特征【 正常是保留会对模型更有优化，但是因为这次数据量过少，保留的话，会让特征过多 】~~
    - ~~不保留原始特征，直接替换【 会失去原本特征的值大小分布 】~~
    - 部分保留原始特征，部分直接替换（ 尝试多次，最终选择 小于等于 3 的时候 直接替换，大于 3 小于等于 10 的时候 保留原始特征 ）
  - ~~使用独热编码，消除分类特征的虚假序关系（ 值类别大于 2 种，小于等于 5 种 ）【 决策树模型不适合，会导致劣化 】~~
