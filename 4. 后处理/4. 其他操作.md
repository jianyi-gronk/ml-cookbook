## 1. 自集成

- 自集成是一种集成学习方法，但与传统集成方法不同，它不需要训练多个独立模型
- 核心思想：模型在不同训练阶段具有互补的预测特性
- 定义
  - 在单个模型训练过程中，通过保存不同训练阶段的模型状态来构建集成
  - 预测时综合这些不同状态的输出，获得更稳定和鲁棒的预测结果

## 2. 伪标签

- 伪标签的定义来自半监督学习，半监督学习的核心思想是借助无标签的数据来提升有监督过程中的模型性能

#### 2.1 基础介绍

- 定义
  - 使用已训练的模型对未标注数据进行预测，将高置信度的预测结果作为 "伪标签"
  - 因为是无标注数据通过模型预测得到的标签，并非一定准确，因此称为 “伪标签”
  - 例如 训练集中有大量数据缺失标签，无法直接用于训练，可以生成伪标签丰富训练数据
- 使用步骤
  - 使用标记数据训练有监督模型 M
  - 使用有监督模型 M 对无标签数据进行预测，得出预测概率 P（ 需确保伪标签数据与原始数据分布相似 ）
  - 通过预测概率 P 筛选高置信度样本
  - 使用 有标记数据 以及 伪标签数据 训练新模型 M'
  - 将 M 替换成 M'，重复以上步骤直至模型效果 在验证集不出现提升 或 达到最大迭代次数
- 尝试变体
  - 协同训练：多个模型互相为对方生成伪标签
  - 自集成：多次添加伪标签得到的多个模型进行集成

#### 2.2 常用工具

- `sklearn.semi_supervised.SelfTrainingClassifier` 专门用于实现伪标签策略
  - 可以将任何标准的监督分类器转换为半监督分类器
  - 迭代地预测未标注数据的伪标签，并将高置信度的预测添加到训练集中
  - 核心参数
    - estimator：基础分类器实例
      - 必须实现 fit 和 predict_proba 方法
      - 例如：LogisticRegression(), RandomForestClassifier() 等
    - criterion：选择准则，默认为 'threshold'
      - 'threshold'：选择预测概率高于阈值的样本
      - 'k_best'：选择预测概率最高的 k_best 个样本
    - threshold：决策阈值，默认为 0.75
      - 当使用 criterion='threshold' 时，只有预测概率高于此值的样本会被添加为伪标签
      - 取值范围：[0, 1)
      - 重要：使用阈值准则时，基础分类器应该是经过良好校准的
    - k_best：每次迭代添加的样本数量，默认为 10
      - 仅当 criterion='k_best' 时使用
    - max_iter：最大迭代次数，默认为 10
      - 如果为 None，则持续迭代直到没有新伪标签或所有未标注样本都被标记

## 3. 预测平滑

- 核心概念
  - 是一种针对序列数据的后处理技术，主要用于处理模型预测在时间或空间维度上的不合理波动
  - 通过利用相邻预测之间的相关性，使输出序列更加稳定、连贯，更符合现实世界的连续性假设
- 常见用法
  - 移动平均
    - 最基础的，即对窗口内的数据取算术平均
    - 除此之外，可以给窗口内的数据赋予不同的权重，通常近期数据权重更高
    - 并且可以额外考虑极值，极值代表窗口内最
  - 中值滤波
    - 用窗口内数据的中值代替当前值，对脉冲噪声有很好的效果
  - 基于模型的平滑
    - 例如，在时间序列中，可以使用状态空间模型，如卡尔曼滤波，来估计系统状态并平滑观测值
  - 基于规则的平滑
    - 例如，在视频动作识别中，如果某个动作只持续了 1 帧，那么很可能是误识别，可以将其替换为前后帧的动作标签

## 4. 基于业务规则

- 通常依赖于对业务本质的理解
  - 目标特征之间的冲突，例如男性，但输出的女性特征
  - 强制性约束规则，例如温度不能低于最低点
  - 异常/离群点处理规则，对于模型预测置信度过低的数据，直接执行逻辑判断预测
